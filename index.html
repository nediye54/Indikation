<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Indikation – nach der Moral des Gleichgewichts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #fafafa;
      color: #111;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 1.6rem;
      margin-bottom: 0.2rem;
    }
    .subtitle {
      color: #555;
      margin-bottom: 1.5rem;
    }
    .block {
      background: white;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      border: 1px solid #eee;
    }
    .question {
      margin-bottom: 12px;
    }
    .answers label {
      display: block;
      margin: 4px 0;
      cursor: pointer;
    }
    button {
      margin-top: 16px;
      padding: 10px 18px;
      border: none;
      border-radius: 8px;
      background: #111;
      color: white;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover {
      opacity: 0.9;
    }
    .k {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .small {
      font-size: 0.85rem;
      color: #555;
    }
  </style>
</head>
<body>

<h1>Indikation</h1>
<div class="subtitle">nach der Moral des Gleichgewichts</div>

<div id="app"></div>

<script>
const variables = [
  {
    key: "freiheit",
    label: "Freiheit",
    questions: [
      "Kannst du Entscheidungen über dein Leben selbst treffen?",
      "Fühlst du dich innerlich frei in deinen Beziehungen?",
      "Kannst du Nein sagen, ohne Angst vor Konsequenzen?"
    ]
  },
  {
    key: "gerechtigkeit",
    label: "Gerechtigkeit",
    questions: [
      "Werden Entscheidungen dir gegenüber fair getroffen?",
      "Wirst du für deine Leistungen angemessen behandelt?",
      "Gibt es klare und gleiche Regeln für alle?"
    ]
  },
  {
    key: "wahrheit",
    label: "Wahrheit",
    questions: [
      "Kannst du offen sagen, was du wirklich denkst?",
      "Weißt du, woran du bei anderen bist?",
      "Werden Probleme ehrlich benannt?"
    ]
  },
  {
    key: "harmonie",
    label: "Harmonie",
    questions: [
      "Gibt es emotionalen Frieden in deinem Umfeld?",
      "Fühlst du dich verstanden?",
      "Sind Konflikte lösbar ohne Eskalation?"
    ]
  },
  {
    key: "effizienz",
    label: "Effizienz",
    questions: [
      "Erreichen deine Handlungen Wirkung?",
      "Wird Energie sinnvoll eingesetzt?",
      "Führen Entscheidungen zu Ergebnissen?"
    ]
  },
  {
    key: "mittel",
    label: "Mittel",
    questions: [
      "Stehen dir genug Ressourcen zur Verfügung?",
      "Hast du Zugang zu dem, was du brauchst?",
      "Fehlen dir finanzielle oder soziale Mittel?"
    ]
  },
  {
    key: "handlungsspielraum",
    label: "Handlungsspielraum",
    questions: [
      "Kannst du Dinge aktiv verändern?",
      "Hast du echte Optionen?",
      "Wirst du gehört, wenn du handelst?"
    ]
  },
  {
    key: "balance",
    label: "Balance",
    questions: [
      "Fühlen sich die Bereiche deines Lebens ausgeglichen an?",
      "Kompensierst du Extreme?",
      "Tragen sich die Teile gegenseitig?"
    ]
  }
];

const answerValues = {
  "klar": 0.8,
  "unklar": 0.5,
  "nein": 0.2
};

function renderForm() {
  const app = document.getElementById("app");
  let html = "";

  variables.forEach(v => {
    html += `<div class="block"><div class="k">${v.label}</div>`;
    v.questions.forEach((q, i) => {
      html += `
        <div class="question">${q}</div>
        <div class="answers">
          <label><input type="radio" name="${v.key}_${i}" value="klar"> klar</label>
          <label><input type="radio" name="${v.key}_${i}" value="unklar"> unklar</label>
          <label><input type="radio" name="${v.key}_${i}" value="nein"> nein</label>
        </div>
      `;
    });
    html += `</div>`;
  });

  html += `<button onclick="evaluate()">Auswerten</button>`;
  app.innerHTML = html;
}

function evaluate() {
  const scores = {};
  variables.forEach(v => {
    let sum = 0;
    let count = 0;
    v.questions.forEach((q, i) => {
      const val = document.querySelector(`input[name="${v.key}_${i}"]:checked`);
      if (val) {
        sum += answerValues[val.value];
        count++;
      }
    });
    scores[v.key] = count > 0 ? sum / count : 0.5;
  });

  renderResult(scores);
}

function renderResult(scores) {
  const app = document.getElementById("app");
  app.innerHTML = `
    <div class="block">
      <div class="k">Dein Gleichgewichtszustand</div>
      ${Object.entries(scores).map(([k,v]) =>
        `<div class="small">${k}: ${v.toFixed(2)}</div>`
      ).join("")}
      ${buildCoordPlotSVG(scores)}
    </div>
  `;
}

function clamp(v,min,max){return Math.max(min,Math.min(max,v));}

function buildCoordPlotSVG(scores){
  const freedom = scores.freiheit;
  const justice = scores.gerechtigkeit;
  const truth = scores.wahrheit;
  const harmony = scores.harmonie;

  const x = freedom - justice;
  const y = truth - harmony;

  const W=320,H=320,pad=34,domain=0.6;
  const nx=clamp(x/domain,-1,1);
  const ny=clamp(y/domain,-1,1);

  const px = pad + (nx+1)*0.5*(W-2*pad);
  const py = pad + (1-(ny+1)*0.5)*(H-2*pad);

  const r = Math.sqrt(nx*nx+ny*ny);
  const color = r<0.33?"#16a34a":r<0.66?"#f59e0b":"#dc2626";

  return `
  <svg viewBox="0 0 ${W} ${H}" width="100%" height="340">
    <circle cx="${W/2}" cy="${H/2}" r="40" fill="none" stroke="#eee"/>
    <circle cx="${W/2}" cy="${H/2}" r="90" fill="none" stroke="#ddd"/>
    <line x1="${W/2}" y1="20" x2="${W/2}" y2="${H-20}" stroke="#ccc"/>
    <line x1="20" y1="${H/2}" x2="${W-20}" y2="${H/2}" stroke="#ccc"/>
    <circle cx="${px}" cy="${py}" r="8" fill="${color}"/>
  </svg>
  <div class="small">Grün = stabil · Orange = Übergang · Rot = kritisch</div>
  `;
}

renderForm();
</script>
</body>
</html>
