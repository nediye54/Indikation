<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MDG – In wenigen Minuten zur Entscheidungssicherheit</title>
  <meta name="description" content="Instabilität früh erkennen, Ursache präzise diagnostizieren, Architektur bauen." />
  <link rel="stylesheet" href="./style.css" />
  <style>
    /* ultra-clean landing tweaks only (page-only) */
    .hero__actions{
      display:flex;
      gap:.75rem;
      flex-wrap:wrap;
      align-items:center;
      margin-top:1.2rem;
    }

    .modal[hidden]{ display:none !important; }
    .modal{
      position:fixed;
      inset:0;
      z-index:50;
      display:grid;
      place-items:center;
      background:rgba(0,0,0,.55);
      padding:1rem;
    }
    .modal__card{
      width:min(560px, 100%);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(10,14,22,.92);
      backdrop-filter: blur(10px);
      padding:1rem;
    }
    .modal__top{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:.75rem;
    }
    .modal__tag{
      display:inline-flex;
      align-items:center;
      gap:.4rem;
      padding:.2rem .55rem;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      font-size:.85rem;
      opacity:.9;
    }
    .modal__x{
      width:38px;
      height:38px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.04);
      color:inherit;
      cursor:pointer;
      display:grid;
      place-items:center;
    }
    .modal__grid{
      display:grid;
      gap:.65rem;
      margin-top:.85rem;
    }
    .modal__label{
      font-weight:800;
      opacity:.9;
    }
    .modal__row{
      display:flex;
      gap:.6rem;
      flex-wrap:wrap;
      align-items:center;
      margin-top:.8rem;
    }

    /* Keep header compact on landing only (layout is handled in style.css patch) */
    @media (max-width: 860px){
      .header__inner{ gap:12px; }
    }
  </style>
</head>

  <header class="header" id="top">
    <div class="container header__inner">
      <a class="brand" href="./index.html" aria-label="Home">
        <span class="brand__mark" aria-hidden="true">MDG</span>
      </a>

      <nav class="nav" aria-label="Main">
        <a class="nav__link" href="./how.html" data-i18n="nav.how">Wie es funktioniert</a>
        <a class="nav__link" href="./why.html" data-i18n="nav.why">Warum MDG</a>
        <a class="nav__link" href="./faq.html" data-i18n="nav.faq">FAQ</a>
      </nav>

      <div class="header__actions">
        <div class="lang" role="group" aria-label="Language">
          <button class="chip chip--ghost" type="button" data-lang="de" aria-pressed="true">DE</button>
          <button class="chip chip--ghost" type="button" data-lang="tr" aria-pressed="false">TR</button>
          <button class="chip chip--ghost" type="button" data-lang="en" aria-pressed="false">EN</button>
        </div>
      </div>

      <!-- Burger stays in DOM for mobile. CSS will hide it on desktop. -->
      <button class="burger" type="button" aria-label="Menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </div>

    <div class="drawer" hidden>
      <div class="drawer__content">
        <a class="drawer__link" href="./how.html" data-i18n="nav.how">Wie es funktioniert</a>
        <a class="drawer__link" href="./why.html" data-i18n="nav.why">Warum MDG</a>
        <a class="drawer__link" href="./faq.html" data-i18n="nav.faq">FAQ</a>
      </div>
    </div>
  </header>

  <main id="main">
    <section class="hero">
      <div class="container hero__inner">
        <div class="hero__copy">
          <h1 class="h1" data-i18n="hero.title">Instabilität früh erkennen. Ursache präzise diagnostizieren. Architektur bauen.</h1>
          <p class="sub" data-i18n="hero.sub">MDG, IDG und ADG machen Spannungen sichtbar – und liefern klare Schritte: Stabilisieren oder Umbauen.</p>

          <div class="hero__actions">
            <a class="btn btn--primary" href="./diagnose.html?mode=private" id="btnPrivate" data-i18n="cta.private">Jetzt ermitteln (privat)</a>
            <button class="btn btn--ghost" type="button" id="btnBusiness" data-i18n="cta.business">Für Unternehmen</button>
          </div>

          <p class="micro" style="margin-top:.7rem; opacity:.85;" data-i18n="hero.note">
            Privat: sofort starten. Business: Token erforderlich.
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer__grid">
      <div>
        <div class="brand brand--footer">
          <span class="brand__mark" aria-hidden="true">MDG</span>
        </div>
        <p class="micro" data-i18n="footer.tag">Strukturdiagnose für Stabilisierung und Umbau.</p>
      </div>
      <div class="footer__legal">
        <a href="./impressum.html" rel="nofollow">Impressum</a>
        <a href="./datenschutz.html" rel="nofollow">Datenschutz</a>
        <a href="./kontakt.html" rel="nofollow">Kontakt</a>
      </div>
    </div>
  </footer>

  <!-- Business Token Modal (opens ONLY after button click) -->
  <div class="modal" id="bizModal" hidden>
    <div class="modal__card" role="dialog" aria-modal="true" aria-labelledby="bizTitle">
      <div class="modal__top">
        <div>
          <div class="modal__tag" data-i18n="biz.tag">Business Zugang</div>
          <h2 class="h3" id="bizTitle" style="margin:.45rem 0 0;" data-i18n="biz.title">Token eingeben</h2>
        </div>
        <button class="modal__x" type="button" id="bizClose" aria-label="Close">×</button>
      </div>

      <p class="micro" style="margin:.75rem 0 0; opacity:.9;" data-i18n="biz.text">
        Kostenpflichtig (249,99€). Bitte Token eingeben.
      </p>

      <div class="modal__grid">
        <div>
          <div class="modal__label" data-i18n="biz.label">Token</div>
          <input class="dx-input" id="bizToken" type="text" placeholder="MDG-XXXX-XXXX" autocomplete="off" />
        </div>

        <div class="modal__row">
          <button class="btn btn--primary" type="button" id="bizGo" data-i18n="biz.next">Weiter</button>
          <button class="btn btn--ghost" type="button" id="bizCancel" data-i18n="biz.cancel">Abbrechen</button>
          <span class="micro" id="bizStatus" style="opacity:.85;"></span>
        </div>
      </div>
    </div>
  </div>

  <script>
  (() => {
    const API_BASE = "https://api.mdg-indikation.de";
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));

    const burger = $(".burger");
    const drawer = $(".drawer");
    if (burger && drawer) {
      burger.addEventListener("click", () => {
        const open = !drawer.hasAttribute("hidden");
        if (open) { drawer.setAttribute("hidden",""); burger.setAttribute("aria-expanded","false"); }
        else { drawer.removeAttribute("hidden"); burger.setAttribute("aria-expanded","true"); }
      });
    }

    const dict = {
      de: {
        "nav.how":"Wie es funktioniert",
        "nav.why":"Warum MDG",
        "nav.faq":"FAQ",
        "hero.title":"Instabilität früh erkennen. Ursache präzise diagnostizieren. Architektur bauen.",
        "hero.sub":"MDG, IDG und ADG machen Spannungen sichtbar – und liefern klare Schritte: Stabilisieren oder Umbauen.",
        "cta.private":"Jetzt ermitteln (privat)",
        "cta.business":"Für Unternehmen",
        "hero.note":"Privat: sofort starten. Business: Token erforderlich.",
        "footer.tag":"Strukturdiagnose für Stabilisierung und Umbau.",
        "biz.tag":"Business Zugang",
        "biz.title":"Token eingeben",
        "biz.text":"Kostenpflichtig (249,99€). Bitte Token eingeben.",
        "biz.label":"Token",
        "biz.next":"Weiter",
        "biz.cancel":"Abbrechen",
        "biz.errEmpty":"Bitte Token eingeben.",
        "biz.errInvalid":"Token ungültig.",
        "biz.ok":"Token ok. Weiter …"
      },
      tr: {
        "nav.how":"Nasıl çalışır",
        "nav.why":"Neden MDG",
        "nav.faq":"SSS",
        "hero.title":"İstikrarsızlığı erken gör. Nedeni doğru teşhis et. Mimari kur.",
        "hero.sub":"MDG/IDG/ADG gerilimi görünür kılar ve net adımlar verir: stabilize et veya yeniden kur.",
        "cta.private":"Hemen başla (özel)",
        "cta.business":"Şirketler için",
        "hero.note":"Özel: hemen başla. Business: token gerekli.",
        "footer.tag":"Stabilizasyon ve yeniden kurulum için yapı teşhisi.",
        "biz.tag":"Business erişim",
        "biz.title":"Token gir",
        "biz.text":"Şirketler için ücretli (249,99€). Token giriniz.",
        "biz.label":"Token",
        "biz.next":"Devam",
        "biz.cancel":"İptal",
        "biz.errEmpty":"Token giriniz.",
        "biz.errInvalid":"Token geçersiz.",
        "biz.ok":"Token tamam. Devam …"
      },
      en: {
        "nav.how":"How it works",
        "nav.why":"Why MDG",
        "nav.faq":"FAQ",
        "hero.title":"Detect instability early. Diagnose precisely. Build architecture.",
        "hero.sub":"MDG/IDG/ADG make tension visible and give clear steps: stabilize or rebuild.",
        "cta.private":"Start now (private)",
        "cta.business":"For companies",
        "hero.note":"Private: start instantly. Business: token required.",
        "footer.tag":"Structure diagnosis for stabilization and rebuild.",
        "biz.tag":"Business access",
        "biz.title":"Enter token",
        "biz.text":"For Companies (249,99€). Please enter token.",
        "biz.label":"Token",
        "biz.next":"Continue",
        "biz.cancel":"Cancel",
        "biz.errEmpty":"Please enter a token.",
        "biz.errInvalid":"Invalid token.",
        "biz.ok":"Token ok. Continuing …"
      }
    };

    function setLang(lang){
      if(!dict[lang]) lang="de";
      localStorage.setItem("mdg_lang", lang);
      document.documentElement.lang = lang;
      $$("[data-lang]").forEach(b => 
        b.setAttribute("aria-pressed", String(b.dataset.lang === lang))
      );
      $$("[data-i18n]").forEach(el => {
        const k = el.dataset.i18n;
        const v = dict[lang][k];
        if (v) el.textContent = v;
      });
    }

    $$("[data-lang]").forEach(btn => 
      btn.addEventListener("click", () => setLang(btn.dataset.lang))
    );

    setLang(localStorage.getItem("mdg_lang") || "de");

    const modal = $("#bizModal");
    const openBtn = $("#btnBusiness");
    const closeBtn = $("#bizClose");
    const cancelBtn = $("#bizCancel");
    const goBtn = $("#bizGo");
    const tokenInp = $("#bizToken");
    const status = $("#bizStatus");

    function t(k){
      const lang = localStorage.getItem("mdg_lang") || "de";
      return (dict[lang] && dict[lang][k]) || (dict.de[k] || k);
    }

    function openModal(){
      status.textContent = "";
      tokenInp.value = (sessionStorage.getItem("mdg_business_token") || localStorage.getItem("mdg_business_token") || "").trim();
      modal.removeAttribute("hidden");
      setTimeout(() => tokenInp.focus(), 60);
    }

    function closeModal(){
      modal.setAttribute("hidden","");
      status.textContent = "";
    }

    openBtn.addEventListener("click", openModal);
    closeBtn.addEventListener("click", closeModal);
    cancelBtn.addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });

    async function verifyToken(token){
      const res = await fetch(`${API_BASE}/api/token/verify`, {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({ token })
      });
      const data = await res.json().catch(() => ({}));
      if (!res.ok) return { ok:false, error: data?.error || "invalid" };
      return { ok: Boolean(data?.ok) };
    }

    goBtn.addEventListener("click", async () => {
      const token = (tokenInp.value || "").trim();
      if(!token){
        status.textContent = t("biz.errEmpty");
        return;
      }
      status.textContent = "…";
      const r = await verifyToken(token);
      if(!r.ok){
        status.textContent = t("biz.errInvalid");
        sessionStorage.setItem("mdg_business_ok","0");
        return;
      }
      status.textContent = t("biz.ok");

      sessionStorage.setItem("mdg_mode","business");
      sessionStorage.setItem("mdg_business_ok","1");
      sessionStorage.setItem("mdg_business_token", token);
      localStorage.setItem("mdg_mode","business");
      localStorage.setItem("mdg_business_ok","1");
      localStorage.setItem("mdg_business_token", token);

      const lang = localStorage.getItem("mdg_lang") || "de";
      window.location.href = `./diagnose.html?mode=business&lang=${encodeURIComponent(lang)}`;
    });

    tokenInp.addEventListener("keydown", (e) => {
      if (e.key === "Enter") goBtn.click();
      if (e.key === "Escape") closeModal();
    });
  })();
  </script>
</body>
</html>
